<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="bootstrap-4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="fontawesome-free-6.5.2-web/css/all.css">
    <title>Admin Dashbord</title>
</head>
<body> 
    <style>
        body {
    font-family: "Lato", sans-serif;
}

.sidenav {
    height: 100%;
    width: 250px;
    position: fixed;
    z-index: 1;
    top: 0;
    left: 0;
    background-color: #40732c;
    overflow-x: hidden;
    padding-top: 60px;
}

.sidenav a, .dropdown-btn {
    padding: 10px 16px;
    text-decoration: none;
    font-size: 18px;
    color: #f2e9e9;
    display: block;
    border: none;
    background: none;
    width: 100%;
    text-align: left;
    cursor: pointer;
    outline: none;
}

.sidenav a:hover, .dropdown-btn:hover {
    color: #f1f1f1;
}

.main {
    margin-left: 250px; /* Same width as the sidebar */
    padding: 0px 10px;
}

/* Dropdown container (hidden by default) */
.dropdown-container {
    display: none;
    background-color: #262626;
}

/* Optional: Style the caret down icon */
.fa-caret-down {
    float: right;
    padding-right: 8px;
}

/* Optional: Hover state on dropdown links */
.dropdown-container a:hover {
    background-color: #404040;
    text-decoration: none;
}

/* Optional: Add a "hover" effect to the open button */
.main span:hover {
    background-color: #111;
    color: white;
}
.container {
    max-width: 1200px;
    margin: 0 auto;
    column-gap: 2opx;
    row-gap: 50px;
    padding: 50px;
    border: 1px solid #ccc;
    border-radius: 5px;
}

h2 {
    text-align: center;
}

.form-group {
    margin-bottom: 20px;
}

label {
    display: block;
    margin-bottom: 5px;
}

input[type="text"],
input[type="email"],
input[type="tel"],
input[type="number"],
textarea,
select {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
}

button {
    padding: 10px 20px;
    background-color: #007bff;
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

button:hover {
    background-color: #0056b3;
}
/* CSS styles for the registration form */
.registration-form {
    display: none; /* Hide the registration form initially */
    max-width: 600px;
    margin: 20px auto;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 5px;
}

#table1{
    display: none;
    margin-left: 50px;

}

#addhall{
    display: none; 
    max-width: 600px;
    margin: 20px auto;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 5px;
}

#allocateHall{
    display: none; 
    max-width: 600px;
    margin: 20px auto;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 5px;
}


table{
    width:50%;
    border-collapse:collapse;
    margin:50px auto;
}
table, th,td{
    border:1px solid black;
}

th, td {
    padding:8px;
    text-align:left;
}

th{
    background-color:#f2f2f2;
}
    </style>
    <div class="sidenav">

            <h4 style="color: white; padding-left: 10px;">Welcome! </h4>
           
        <button class="dropdown-btn"><i class="fa fa-user"></i>
            <td>&nbsp;</td>Profile
        </button>
        <div class="dropdown-container">
            <a href="#" onclick="openRegistrationForm()">change password </a>
            <a href="#" onclick="openRegistrationForm()">Student details </a>
        </div>
        <button class="dropdown-btn"><i class="fas fa-clipboard-check"></i> View Hall
        </button>
        <div class="dropdown-container">
            <a href="#" onclick="addHall()">Add Hall</a>
            <a href="#" onclick="openTable()">View Allocate Hall</a>
        </div>

        <button class="dropdown-btn"><i class="fa fa-book"></i>
            <td>&nbsp;</td>Notification
        </button> 
        <div class="dropdown-container">
            <a href="#">view all Notification</a>
        </div>
        <button class="dropdown-btn"> <i class="fas fa-times lg-4"></i>
            <tb>&nbsp;</tb> Signout
        </button>
        <div class="dropdown-container">
            <a href="/logout">close Application</a>
        </div>
    </div>
    <div class="container1" style="margin-left: 150px; padding-left: 200px;" id="Main">
        <div class="row">
            <div class="col-md-5 ">
                <h2>New here?</h2>
                <ul>
                    <li>Welcome to the hall Allocation System.</li>
                    <li>Complete your profile</li>
                    <li>Generate Acceptance invoice</li>
                </ul>
                <p>If you are a new student, kindly follow these steps.</p>
            </div>
            <div class="col-md-5">
                <h2>Need Help?</h2>
                <p>If you need any help, kindly send a mail to <br>
                    help@teneceschoolsupport.com and we will <br>
                    attend to you. You can also use the chat box <br>
                    on the log in page</p>
            </div>
        </div>
    </div>
    <div id="registrationForm" class="registration-form">
        <h2>Student Registration Form</h2>
        <form action="#" method="post">
            <div class="form-group">
                <label for="fullname">Full Name:</label>
                <input type="text" id="fullname" name="fullname" value="" disabled>
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" value="" disabled>
            </div>
            <div class="form-group">
                <label for="phone">Phone Number:</label>
                <input type="tel" id="phone" name="phone" value="" required>
            </div>
            <div class="form-group">
                <label for="address">Address:</label>
                <textarea id="address" name="address" ></textarea>
            </div>
            <div class="form-group">
                <label for="dob">Date of Birth:</label>
                <input type="date" id="dob" name="dob" required>
            </div>
            <div class="form-group">
                <label for="gender">Gender:</label>
                <select id="gender" name="gender" required>
                    <option value="">Select</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <label for="education">Highest Education Level:</label>
                <select id="education" name="education" required>
                    <option value="">Select</option>
                    <option value="high_school">High School</option>
                    <option value="undergraduate">Undergraduate</option>
                    <option value="graduate">Graduate</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <button type="submit">Submit</button>
            </div>
        </form>
     
    </div>

    <!--this is for student display-->
    <div id="table1" class="container1">
            <h1 style="text-align: center;">Allocated </h1>
            <table>
                <thead>
                    <tr>
                        <th>Hall Name</th>
                        <th>Capacity</th>
                        <th>Allocate Hall</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (data && data.hall && data.hall.length > 0) { %>
                        <% data.hall.forEach(hall => { %>
                            <tr>
                                <td><%= hall.hallName %></td>
                                <td><%= hall.capacity %></td>
                                <td><a href="/allocate/hall/page?id=<%= hall._id %>"> Allocate</a></td>
                            </tr>
                        <% }) %>
                    <% } else { %>
                        <tr>
                            <td colspan="2">No halls found</td>
                        </tr>
                    <% } %>
                </tbody>
            </table>
            
           
    
                
              

            <!--end student display-->
    </div>

    <!-- add hall -->
    <div id="addhall" class="container1">
        <form id="form1" action="/register/hall" method="post">
            <label for="name">Hall Name</label>
            <input type="text" name="hallName" required>
            
            <label for="capacity">Hall Capacity</label>
            <input type="number" name="hallCapacity" required>
          
            <button type="submit">Add Hall</button>
        </form>
    </div>
    
    <script>
        document.getElementById("form1").addEventListener("submit", async function (event) {
            event.preventDefault(); // Prevent the form from submitting the default way
    
            const hallName = event.target.hallName.value;
            const hallCapacity = event.target.hallCapacity.value;
    
            try {
                const response = await fetch("/register/hall", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ hallName, hallCapacity })
                });
    
                const data = await response.json();
                
                if (response.ok) {
                    alert(data.message || "Hall added successfully");
                    event.target.reset(); // Clear the form after successful submission
                } else {
                    alert(data.message || "Failed to add hall");
                }
            } catch (error) {
                alert("An error occurred: " + error.message);
            }
        });
    </script>
    

    <!-- allocate hall -->
     <div id="allocateHall" class="container1">
    <div class="container mt-5">
        <h2>Allocate Hall to Department</h2>
        
        <form  action="/allocate/hall" method="post" id="allocationForm">
          <div class="form-group">
            <label for="department">Department Name:</label>
            <input type="text" id="department" name="department" class="form-control" required>
          </div>
    
          <div class="form-group">
            <label for="students">Number of Students:</label>
            <input type="number" id="students" name="students" class="form-control" required>
          </div>
          <div class="form-group">
            <label for="students">course Code:</label>
            <input type="text" id="students" name="courseCode" class="form-control" required>
          </div>
    
          <button type="submit" class="btn btn-primary">Allocate Hall</button>
        </form>
    
        <div id="result" class="mt-3"></div>
      </div>
    </div>

    <script>
        // const form1 = document.getElementById('allocationForm');
    
        // form1.addEventListener('submit',async (e) => {
        //     e.preventDefault();
    
        //     // rest errors
        //     // emailError.textContent = '';
        //     // passwordError.textContent = '';
    
        //     // get the form values
        //     const department = form.department.value
        //     const students = form.students.value
            
        //     try {
               
        //             const res = await fetch('/allocateHall', {
        //                 method: 'POST',
        //                 body: JSON.stringify({ department, students }),
        //                 headers: { 'Content-Type': 'application/json' },
        //             })
                                      
        //             const data = await res.json();
        //             console.log(data);

        //             if(data.newHall){

        //                 alert("hall added sucessfully")
        //                 location.assign('/studentDash')
        //             }
            
        //     } catch (error) {
        //             console.log(error);
        //         }
        // });
    </script>
    
    <script>
        const form = document.getElementById('form1');
        const matError = document.querySelector('.matno.error');
        const passwordError = document.querySelector('.password.error');
    
    
        form.addEventListener('submit',async (e) => {
            e.preventDefault();
    
            // rest errors
            // emailError.textContent = '';
            // passwordError.textContent = '';
    
            // get the form values
            const hallName = form.hallName.value
            const hallCapacity = form.hallCapacity.value
            
            try {
               
                    const res = await fetch('/register/hall', {
                        method: 'POST',
                        body: JSON.stringify({ hallName, hallCapacity }),
                        headers: { 'Content-Type': 'application/json' },
                    })
                                      
                    const dat = await res.json();
                    console.log(dat);

                    if(dat.newHall){

                        alert("hall added sucessfully")
                        location.assign('/studentDash')
                    }
            
            } catch (error) {
                    console.log(error);
                }
        });
    </script>
         
    <script>
       function openNav() {
            document.querySelector(".sidenav").style.width = "250px";
        }

        function closeNav() {
            document.querySelector(".sidenav").style.width = "0";
        }

        
    document.addEventListener('DOMContentLoaded', ()=>{
        const dropdownButtons = document.querySelectorAll('.dropdown-btn');

        dropdownButtons.forEach(button => {
            button.addEventListener('click', (event)=>{
                //close all dropdowns
                document.querySelectorAll('.dropdown-container').forEach(content =>{
                    content.style.display = 'none';
                });

                //open the clicked dropdown
                const dropdownContent = button.nextElementSibling;
                if (dropdownContent.style.display === 'none' || dropdownContent.style.display ==='') {
                    dropdownContent.style.display = 'block';
                }
                else {
                    dropdownContent.style.display = 'none';
                }

                // stop propagation to avoid closing when clicking inside the dropdown
                event.stopPropagation();
            });
        });

        //close all dropdowns when clicking outside 
        document.addEventListener('click', ()=>{
            document.querySelectorAll('dropdown-container').forEach(content=>{
                content.style.display = 'none';
            });
        });
    });

    function openRegistrationForm() {
    document.getElementById("registrationForm").style.display = "block";
    document.getElementById("Main").style.display = "none";
    document.getElementById("table1").style.display = "none";
    document.getElementById("addhall").style.display = "none";
    document.getElementById("allocateHall").style.display = "none";
}

function openTable(){
    document.getElementById("table1").style.display = "block";
    document.getElementById('registrationForm').style.display = "none";
    document.getElementById("Main").style.display = "none";
    document.getElementById("addhall").style.display = "none";
    document.getElementById("allocateHall").style.display = "none";
}
  
function addHall(){
    document.getElementById("addhall").style.display = "block";
    document.getElementById('registrationForm').style.display = "none";
    document.getElementById("table1").style.display = "none";
    document.getElementById("Main").style.display = "none";
    document.getElementById("allocateHall").style.display = "none";
}

function allocateHall() {
    document.getElementById("allocateHall").style.display = "block";
    document.getElementById("Main").style.display = "none";
    document.getElementById("table1").style.display = "none";
    document.getElementById("addhall").style.display = "none";
    document.getElementById('registrationForm').style.display = "none";
}
    </script>
    
    <footer>All right reserved @2024</footer>
</body>
</html>